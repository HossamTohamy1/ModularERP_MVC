@using ModulerERP_MVC_.Finance.Treasuries.ViewModels
@model TreasuryViewModel
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
}
@{
    ViewData["Title"] = "Delete Treasury";
}

<div class="container-fluid">
    <!-- Header with Breadcrumb -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="d-flex justify-content-between align-items-center">
                <div>
                    <h2 class="mb-2">
                        <i class="fas fa-trash text-danger me-2"></i>
                        @ViewData["Title"]
                    </h2>
                    <nav aria-label="breadcrumb">
                        <ol class="breadcrumb mb-0">
                            <li class="breadcrumb-item">
                                <a asp-action="Index">
                                    <i class="fas fa-money-bill-wave me-1"></i>Treasuries
                                </a>
                            </li>
                            <li class="breadcrumb-item active" aria-current="page">Delete: @Model.Name</li>
                        </ol>
                    </nav>
                </div>
                <div>
                    <a asp-action="Index" class="btn btn-outline-secondary">
                        <i class="fas fa-arrow-left me-2"></i>Back to List
                    </a>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-lg-8 mx-auto">
            <!-- Warning Card -->
            <div class="card border-danger shadow-lg mb-4">
                <div class="card-header bg-danger text-white">
                    <h5 class="mb-0">
                        <i class="fas fa-exclamation-triangle me-2"></i>Confirm Deletion
                    </h5>
                </div>
                <div class="card-body">
                    <!-- Main Warning Alert -->
                    <div class="alert alert-warning border-warning shadow-sm" role="alert">
                        <div class="d-flex align-items-start">
                            <div class="flex-shrink-0">
                                <i class="fas fa-exclamation-triangle fa-3x text-warning"></i>
                            </div>
                            <div class="flex-grow-1 ms-3">
                                <h5 class="alert-heading">
                                    <i class="fas fa-hand-paper me-2"></i>Important Warning!
                                </h5>
                                <p class="mb-2">
                                    You are about to delete the treasury <strong class="text-danger">"@Model.Name"</strong>
                                </p>
                                <hr>
                                <p class="mb-0">
                                    <i class="fas fa-info-circle me-2"></i>
                                    <strong>This action cannot be undone.</strong>
                                    The treasury will be permanently deleted from the system.
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Treasury Details -->
                    <div class="card bg-light mb-4">
                        <div class="card-body">
                            <h6 class="card-title mb-3">
                                <i class="fas fa-info-circle text-info me-2"></i>
                                Treasury details to be deleted:
                            </h6>

                            <dl class="row mb-0">
                                <dt class="col-sm-4 text-muted">
                                    <i class="fas fa-signature me-2"></i>Name:
                                </dt>
                                <dd class="col-sm-8">
                                    <strong>@Model.Name</strong>
                                </dd>

                                <dt class="col-sm-4 text-muted">
                                    <i class="fas fa-building me-2"></i>Company:
                                </dt>
                                <dd class="col-sm-8">@Model.CompanyName</dd>

                                <dt class="col-sm-4 text-muted">
                                    <i class="fas fa-money-bill me-2"></i>Currency:
                                </dt>
                                <dd class="col-sm-8">
                                    <span class="badge bg-info">
                                        @Model.CurrencyCode - @Model.CurrencySymbol
                                    </span>
                                </dd>

                                <dt class="col-sm-4 text-muted">
                                    <i class="fas fa-wallet me-2"></i>Balance:
                                </dt>
                                <dd class="col-sm-8">
                                    <strong class="@(Model.Balance >= 0 ? "text-success" : "text-danger") fs-5">
                                        @Model.Balance.ToString("N2") @Model.CurrencySymbol
                                    </strong>
                                </dd>

                                <dt class="col-sm-4 text-muted">
                                    <i class="fas fa-toggle-on me-2"></i>Status:
                                </dt>
                                <dd class="col-sm-8">
                                    @if (Model.Status == ModulerERP_MVC_.Common.Enums.Finance_Enum.TreasuryStatus.Active)
                                    {
                                        <span class="badge bg-success">
                                            <i class="fas fa-check-circle me-1"></i>Active
                                        </span>
                                    }
                                    else
                                    {
                                        <span class="badge bg-danger">
                                            <i class="fas fa-times-circle me-1"></i>Inactive
                                        </span>
                                    }
                                </dd>

                                @if (!string.IsNullOrEmpty(Model.Description))
                                {
                                    <dt class="col-sm-4 text-muted">
                                        <i class="fas fa-align-left me-2"></i>Description:
                                    </dt>
                                    <dd class="col-sm-8 text-muted">@Model.Description</dd>
                                }
                            </dl>
                        </div>
                    </div>

                    <!-- Additional Warning -->
                    @if (Model.Balance != 0)
                    {
                        <div class="alert alert-danger" role="alert">
                            <i class="fas fa-exclamation-circle me-2"></i>
                            <strong>Alert:</strong> This treasury contains a balance of
                            <strong class="text-decoration-underline">@Model.Balance.ToString("N2") @Model.CurrencySymbol</strong>
                        </div>
                    }

                    <!-- Delete Form -->
                    <form asp-action="Delete" method="post" id="deleteForm">
                        <input type="hidden" asp-for="Id" />

                        <!-- Confirmation Checkbox -->
                        <div class="form-check mb-4">
                            <input class="form-check-input"
                                   type="checkbox"
                                   id="confirmDelete"
                                   required>
                            <label class="form-check-label fw-bold" for="confirmDelete">
                                <i class="fas fa-check-square me-2"></i>
                                I confirm that I want to permanently delete this treasury
                            </label>
                        </div>

                        <!-- Action Buttons -->
                        <div class="d-flex justify-content-between pt-3 border-top">
                            <a asp-action="Index" class="btn btn-lg btn-secondary">
                                <i class="fas fa-times me-2"></i>Cancel
                            </a>
                            <button type="submit"
                                    class="btn btn-lg btn-danger px-5"
                                    id="deleteButton"
                                    disabled>
                                <i class="fas fa-trash me-2"></i>Confirm Delete Permanently
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        $(document).ready(function() {
            // Add animation to card
            $('.card').hide().fadeIn(500);

            // Enable/Disable delete button based on checkbox
            $('#confirmDelete').on('change', function() {
                $('#deleteButton').prop('disabled', !this.checked);
            });

            // Confirmation on submit
            $('#deleteForm').on('submit', function(e) {
                if (!confirm('⚠️ Final Warning!\n\nAre you absolutely sure you want to delete the treasury "@Model.Name"?\n\nThis action cannot be undone!')) {
                    e.preventDefault();
                    return false;
                }

                // Show loading state
                $('#deleteButton').html('<i class="fas fa-spinner fa-spin me-2"></i>Deleting...')
                                  .prop('disabled', true);
            });
        });
    </script>
}

<style>
    .card.border-danger {
        border-width: 2px;
    }

    .alert-warning {
        background-color: #fff3cd;
        border-left: 4px solid #ffc107;
    }

    #confirmDelete:checked ~ label {
        color: #dc3545;
    }
</style>